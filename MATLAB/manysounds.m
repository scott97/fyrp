% Source data

% radius in mm
% time in ms
% initial change in radius velocity (mm/ms)
radii = [1.7000 1.5000 1.5000 1.6000 1.6000 1.6000 1.8000 0.8000 1.8000 0.8000 1.6000 0.5000 0.9000 0.4000 0.7000 0.8000 0.8000 0.7000 0.8000 0.8000 1.0000 0.5000 0.8000 0.8000 0.8000 0.5000 0.8000 0.9000 0.8000 0.7000 0.8000 0.7000 0.7000 0.9000 1.0000 0.8000 1.0000 1.2000 1.4000 0.8000 0.5000 1.0000 1.0000 1.0000 1.0000 1.3000 0.5000 1.0000 0.8000 1.1000 0.7000 0.9000 0.9000 1.1000 0.5000 1.0000 1.0000 1.1000 0.7000 0.5000 0.5000 1.5000 1.6000 1.3000 1.4000 1.1000 1.3000 1.3000 1.3000 1.3000 1.3000 0.5000 1.0000 1.0000 1.0000 0.8000 0.7000 0.5000 1.0000 1.0000 0.6000 1.0000 0.6000 0.7000 0.5000 0.6000 0.9000 1.0000 0.7000 0.7000 0.6000 0.9000 0.9000 0.5000 0.5000 0.5000 0.5000 1.3000 1.6000 0.4000 0.8000 0.7000 0.5000 0.7000 0.7000 0.5000 0.8000 1.1000 0.8000 0.9000 1.1000 1.2000 0.6000 0.4000 1.5000 0.8000 0.8000 0.8000 1.0000 0.8000 0.8000 1.5000 0.8000 0.8000 0.5000 0.7000 1.2000 1.0000 0.8000 0.6000 0.6000 1.0000 0.7000 0.8000 0.7000 1.0000 0.9000 1.0000 1.0000 1.0000 1.1000 1.0000 0.9000];
times = [  21.4   23.9   25.1   28.0   30.3   32.0   63.5   66.5   68.9   73.2   93.3  109.1  118.1  128.8  152.6  153.8  179.2  199.2    202  219.1  222.8  223.9  229.5  237.6  238.9  269.1  274.9    277  280.5    283  286.3  303.4  305.9    328  349.1    362    379  383.8  388.8  391.9  444.4    460  469.1  471.3  473.2  475.6  481.8  485.3  497.4  525.7  533.7  535.2  538.3  545.1  549.5  558.5    560  571.7  599.9  614.4  625.5  637.1  639.4  648.3    651  655.6  658.3  661.5  664.4  667.3  670.8    690  700.5  711.2  719.4  729.0  748.8  753.6  774.5  775.6  803.6  806.6  824.8  827.0  830.4  841.9  854.0  856.1  867.0  871.5  884.1  888.7  930.5  936.8  941.5  948.0  949.3  971.2  973.1  995.2 1018.6 1020.5 1025.8 1039.5 1089.4 1103.4 1104.8 1118.1 1131.9 1142.6 1148.6 1152.2 1155.2 1161.0 1183.9 1201.4 1205.1 1208.4 1211.3 1216.8 1242.6 1244.0 1247.0 1265.2 1270.2 1274.8 1278.3 1286.9 1290.0 1299.5 1308.9 1312.5 1341.3 1344.1 1407.3 1410.1 1417.8 1422.0 1426.5 1477.8 1479.4 1495.4 1497.8];
icdeltadot = [4.0598 4.8573 4.819 7.0355 4.182 5.6771 6.9432 5.5471 6.7095 4.484 5.7389 5.0065 4.791 2.141 4.8574 4.7049 4.2462 4.3461 5.1617 5.7867 4.6559 3.2164 6.2767 4.2588 5.2246 6.1548 6.8144 4.5159 4.0826 4.5526 3.2544 4.7512 3.8672 7.4522 3.7635 4.6319 6.8571 5.6198 6.8083 7.0921 3.2381 4.2958 4.7955 4.6325 5.439 5.1342 4.6823 5.6323 6.0692 4.3595 7.003 4.8187 4.291 4.1153 5.7143 3.5818 5.1785 4.1647 4.4568 5.8675 4.8151 5.4591 3.6784 3.3931 6.7634 4.137 5.0652 5.3273 3.0535 4.5187 6.3851 4.3212 5.5878 2.8016 3.9688 5.4097 5.6405 5.0465 6.6604 4.5597 4.3217 5.4231 4.911 4.5041 5.3161 5.2981 4.6584 4.0531 5.3156 3.628 3.9894 5.5403 3.4337 6.4305 6.4446 5.3337 5.0473 4.8854 4.1723 5.3903 3.3427 4.7926 5.9524 5.6155 2.9129 4.7451 3.9259 4.6289 7.1485 4.2647 3.9455 4.4033 4.4911 4.5647 3.3965 4.5232 4.2293 3.5063 4.0621 2.7659 5.2556 4.238 3.2507 6.7513 4.8987 4.1373 6.7017 6.0137 5.388 4.6288 6.8996 3.4734 6.9973 5.8429 4.5822 4.5093 4.4168 4.2832 4.7799 4.2113 4.6589 3.9247 5.6488];


data = [
	radii;
    times;
    icdeltadot;
];


% Sample rate
fs = 44100;

% Get data
getsounds = memoize(@generatesounds); % slow
[y,~] = getsounds(data, fs);

% Analyse data
[s,f] = cwt(y,fs);
t = (0:numel(y)-1)/fs;
plot_peaks(s,f,t,'Sythesised by me, wavelet',0.2);
